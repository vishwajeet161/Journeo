# ============ SERVER ============
server.port=${PORT:8080}
spring.application.name=api-gateway

# ============ EUREKA ============
eureka.client.service-url.defaultZone=${EUREKA_URL:http://localhost:8761/eureka/}
eureka.instance.instance-id=${spring.application.name}:${random.value}

# ============ GATEWAY ROUTES ============
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.gateway.discovery.locator.lower-case-service-id=true

# Public endpoints (no authentication needed)
spring.cloud.gateway.routes[0].id=user-service-auth
spring.cloud.gateway.routes[0].uri=lb://user-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/auth/**,/api/users/register
spring.cloud.gateway.routes[0].filters[0]=StripPrefix=1

# Secured endpoints (require authentication)
spring.cloud.gateway.routes[1].id=user-service-secure
spring.cloud.gateway.routes[1].uri=lb://user-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/users/**
spring.cloud.gateway.routes[1].filters[0]=AuthenticationFilter


# Eureka Dashboard
spring.cloud.gateway.routes[2].id=eureka-dashboard
spring.cloud.gateway.routes[2].uri=http://localhost:8761
spring.cloud.gateway.routes[2].predicates[0]=Path=/eureka/web
spring.cloud.gateway.routes[2].filters[0]=SetPath=/

# ============ JWT ============
app.jwt.secret=${JWT_SECRET:J0urn3o_@p1G@t3w@y_2025_S3cur3_Key!}
app.jwt.expiration=${JWT_EXPIRATION_MS:86400000}

# ============ SECURITY ============
# CORS Configuration
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-origins=${ALLOWED_ORIGINS:http://localhost:4200}
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations.[/api/**].allow-credentials=true

# ============ LOGGING ============
logging.level.com.journeo.gateway=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.org.springframework.security=INFO